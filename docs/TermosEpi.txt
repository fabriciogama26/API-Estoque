Tela: Termo de EPI

Visao geral

Gerar e baixar o termo de responsabilidade de EPI para colaboradores, com pre-visualizacao HTML e PDF renderizado no cliente.

Arquitetura (modular)

- Hook useTermoEpi: controla formulario, validacao, carga do contexto, preview HTML e download do PDF.
- Servico: termoEpiService (fetchTermoEpiContext) usando dataClient (Supabase ou local).
- Utils: TermoEpiUtils (download PDF) e template compartilhado `shared/documents/epiTermTemplate.js`.
- Erros: logError com page 'termo-epi' registra falhas de geracao e download em app_errors.

Fluxos

- Formulario: matricula ou nome (obrigatorio informar um), periodo opcional (dataInicio/dataFim). Valida datas (formato e ordem).
- Gerar termo: busca contexto via service, monta HTML pelo template e mostra preview em iframe.
- Download: gera PDF a partir do HTML e contexto; mostra erro em caso de falha.
- Resumo: exibe colaborador, centro de servico, ultima entrega, itens entregues e origem dos dados (local ou Supabase).

Boas praticas

- Validar datas antes de chamar o service; informar pelo menos matricula ou nome.
- Exibir mensagens de erro no preview e registrar no log para acompanhar falhas de PDF ou carga.

Atualizacao 2025-12

- Tela refatorada com hook/service/utils; logging de erros adicionado; preview e download separados por estado isLoading/isDownloading.
