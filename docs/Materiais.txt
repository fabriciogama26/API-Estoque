Tela: Materiais
===============

Objetivo
--------
- Cadastrar e manter EPIs (nome, fabricante, validade, CA, valor unitario, estoque minimo, status).
- Registrar historico de precos para auditoria.

Fluxo geral
-----------
1. Formulario cria ou atualiza materiais via `dataClient.materiais`.
2. Tabela lista materiais com filtros por termo/campos.
3. Modal de historico (`MateriaisHistoryModal`) mostra variaÃ§ao de preco.

Campos principais
-----------------
- `nome`, `fabricante`, `validadeDias`, `ca`, `valorUnitario`, `estoqueMinimo`, `ativo`.
- Valor unitario usa helpers de formatacao (`formatCurrencyInput`).
- Atualizacoes registram usuario responsavel e timestamp.

APIs
----
- `dataClient.materiais.list()`
- `dataClient.materiais.create(payload)`
- `dataClient.materiais.update(id, payload)`
- `dataClient.materiais.priceHistory(id)`
  - Remoto: mapeia para `/api/materiais`, `/api/materiais/:id`, `/api/materiais/:id/historico-precos`.
  - Local: persiste no `localStorage` e adiciona registros em `materialPriceHistory`.

Validacoes
----------
- Frontend garante campos obrigatorios e numeros positivos.
- Servicos validam:
  - Nome/fabricante nao vazios.
  - `validadeDias` > 0.
  - `valorUnitario` > 0.
  - `estoqueMinimo` >= 0 (ou null).
  - CA nao vazio.
- Historico de preco e gravado sempre que `valorUnitario` muda.

Comportamento da UI
-------------------
- `isSaving` desabilita botoes e mostra feedback textual.
- Erros exibem mensagens do `Error.message`.
- Abertura do modal busca cache local antes de nova chamada.
- Edicao preenche formulario com valores formatados.

Dependencias
------------
- `AuthContext` para resolver usuario (nome exibido no historico).
- `MateriaisRules` para sanitizacao/formatacao.
- `dataClient` para alternar entre modo remoto e local.
- Seeds locais fornecem dois materiais de exemplo com historico inicial.
