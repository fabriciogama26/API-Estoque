Tela: Cadastro de Materiais (EPI)

Visao geral

Cadastro e manutencao de materiais/EPI com fabricantes, grupos, cores, caracteristicas e historico de precos. Suporta modo Supabase e local.

Arquitetura (modular)

- Hooks: useMateriaisController (formulario, filtros, tabela, paginacao), useMateriais (lista), useFabricantes/grupos/etc para catalogos.
- Servicos: materiaisService (listar/criar/atualizar/historico), MaterialService (backend legacy), integra dataMode remoto/local.
- Utils: MateriaisUtils (formatacao, parse de currency, sanitizacao), duplicidade com hashes na migration dedicada.
- Erros: useErrorLogger('materiais') envia falhas para app_errors.

Fluxos principais

- Formulario: dados basicos (nome/item, fabricante, grupo, numero especifico), medidas (calcado/vestimenta), CA, validade, valor unitario, estoque minimo, ativo.
- Historico de preco: tabela/mensagem ao salvar com diffs (updateHistory) e timeline.
- Filtros: termo livre, grupo, fabricante, ativo; limpar restaura defaults; paginacao local.
- Acoes: editar, historico, ativar/desativar material; duplicidade prevenida por hash_base/hash_completo (fabricante+grupo+item+numeroEspecifico+caracteristicas).

Boas praticas

- Sempre usar parse/format de currency via utils; validar campos numericos antes do submit.
- Respeitar mensagens de duplicidade do gatilho; corrigir catalogos antes de forcar insert.

Atualizacao 2025-12

- Tela modularizada com hooks/services/utils; imports corrigidos (MateriaisUtils case-sensitive); logging de erros ativo.
