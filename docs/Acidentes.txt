Tela: Cadastro de Acidentes
===========================

Visão geral
-----------
- Registro completo de acidentes com colaboradores, incluindo dados de SST (tipo, agente, lesão, parte lesionada, HHT, dias perdidos/debitados).
- Filtros permitem localizar registros existentes por termo, tipo, agente e centro de serviço; histórico detalha alterações campo a campo.
- Compatível com modo Supabase e modo local (mesmo conjunto de componentes e validações).

Fluxo principal
---------------
1. Ao montar, `AcidentesPage` carrega a lista de acidentes (`dataClient.acidentes.list`) e popula datalists com colaboradores (`dataClient.pessoas.list`).
2. Lists auxiliares (agentes, partes lesionadas, tipos, lesões, locais) são buscadas com `api.acidentes.agents/parts/types/lesions/locals` e exibidas como sugestões.
3. `validateAcidenteForm` garante consistência dos dados antes de criar ou atualizar (`dataClient.acidentes.create/update`).
4. Após salvar, a página recarrega a lista de acidentes, limpa o formulário e mantém cache de históricos separado por ID.
5. O modal de histórico (`AcidentesHistoryModal`) consulta `dataClient.acidentes.history(id)` apenas quando o usuário solicita, armazenando a resposta em cache.

Campos principais
-----------------
- Dados do colaborador: matrícula, nome (preenchido automaticamente ao selecionar a matrícula), cargo, centro de serviço/local.
- Informações do acidente: data, tipo, agente, lesão, parte lesionada, local, CID, CAT, observação.
- Métricas: dias perdidos, dias debitados, HHT (horas homem trabalhadas).
- Controle de status: `registradoPor` e `atualizadoPor` são preenchidos a partir do usuário autenticado.

Validações
----------
- Matrícula obrigatória; quando informada, o sistema busca os dados da pessoa para preencher nome/cargo/centro de serviço.
- Data precisa ser válida (`yyyy-mm-dd`).
- Campos numéricos (dias, HHT) devem ser ≥ 0.
- Tipos/listas: os valores precisam existir nas listas retornadas pelo backend para evitar inconsistências.
- Modo Supabase verifica referências no banco e mantém histórico em `acidente_historico`.

Filtros e tabela
----------------
- Filtros por termo (nome/matrícula), tipo, centro de serviço e agente (`filterAcidentes`).
- A tabela mostra os principais campos e disponibiliza ações de editar e visualizar histórico.
- Mensagens de erro do formulário e da listagem são exibidas separadamente (`formError` e `listError`).

Componentes e utilitários
-------------------------
- `src/pages/Acidentes.jsx`
- `src/components/Acidentes/AcidentesForm.jsx`
- `src/components/Acidentes/AcidentesFilters.jsx`
- `src/components/Acidentes/AcidentesTable.jsx`
- `src/components/Acidentes/AcidentesHistoryModal.jsx`
- `src/rules/AcidentesRules.js`
- `src/config/AcidentesConfig.js`

Integração com dashboards
-------------------------
- Os registros alimentam o dashboard de acidentes (`docs/DashboardAcidentes.txt`).
- Campos de HHT, dias perdidos e debitados são fundamentais para calcular TF/TG.
- As listas de agentes/partes/lesões reaproveitam tabelas de domínio mantidas nas migrations Supabase.
