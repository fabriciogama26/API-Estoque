Tela: Autenticacao (Login e Reset de Senha)

Visao geral

Login com Supabase Auth no modo remoto e modo local (credenciais via .env.local) para desenvolvimento offline. Recuperacao de senha via email e pagina de redefinicao com validacao do link.

Arquitetura (modular)

- Hooks: useLoginForm (estado, submit, recuperacao), useResetPassword (restaura sessao do link, valida senhas, envia update).
- Servicos: authService (resetPasswordForEmail, updateUser, restoreResetSession) usando supabaseClient; errorLogService registra falhas em app_errors.
- Contexto: AuthContext fornece user, login, recoverPassword, logout; suporta persistSession e autoRefresh.

Fluxos

- Login: email + senha; em modo local compara com VITE_LOCAL_USERNAME/PASSWORD; em modo remoto usa supabase.auth.signInWithPassword.
- Recuperacao: envia resetPasswordForEmail com redirect configuravel; feedback de sucesso/erro.
- ResetPasswordPage: valida sessao via getSession/getSessionFromUrl/exchangeCodeForSession/setSession; exige senha >=8 e confirmacao; redireciona ao login apos sucesso.

Boas praticas

- Manter variaveis VITE_SUPABASE_URL/ANON_KEY configuradas; usar redirectTo para reset se necessario.
- Registrar erros (login, recovery, updatePassword, restoreResetSession) em app_errors para auditoria.

Atualizacao 2025-12

- Telas modularizadas com hooks/services e logging; compatibilidade com modo local preservada.
