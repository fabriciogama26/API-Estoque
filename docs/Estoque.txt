Tela: Estoque Atual
======================

Objetivo
-------
- Monitorar o estoque atual por material, visualizar alertas automáticos e permitir atualizações em linha para o limite mínimo de estoque.
- Todos os dados agora fluem por rotas serverless suportadas pela Supabase.

Filtros
-------
- `ano` / `mes` (números, opcional): encaminhado para `GET /api/estoque` para recalcular os saldos do período selecionado.
- `termo` (string, opcional): filtro do lado do cliente para listas de alertas e itens.

Editor Em Linha
-------------
- Cada linha expõe um `estoqueMinimo` editável.
- Os valores devem ser numéricos e >= 0; envios vazios são rejeitados antes de atingir a API.
- Salvar gatilhos `PUT /api/materiais/:id` com `{ estoqueMinimo, usuarioResponsavel }`.

APIs
----
- `GET /api/estoque?ano=&mes=` retorna `{ itens, alertas }` após a agregação do Supabase.
- `PUT /api/materiais/:id` atualiza o registro de material; o histórico do Supabase é gerenciado pelo auxiliar de backend quando outros campos são alterados.

Regras de Negócios
--------------
- Os alertas são produzidos no lado do servidor via `verificarEstoqueMinimo`.
- Os saldos de estoque dependem dos dados do Supabase (`entradas`, `saidas`, `materiais`) e são recalculados a cada solicitação.
- O salvamento em linha limpa o histórico em cache para que outras visualizações busquem valores atualizados.

Comportamento da IU
------------
- Os botões exibem carregadores textuais (`Filtrando...`, `Salvando...`) e desabilitam entradas enquanto aguardam respostas.
- A lista de alertas exibe informações de déficit derivadas do payload no lado do cliente.
- Erros gerais e por item são exibidos nas respostas da API.

Dependências
------------
- Requer sessão autenticada do Supabase (token gerenciado por `src/services/api.js`).
- Impacta outras telas (Painel, Saídas) após o ajuste de `estoqueMinimo`.
- Utiliza contexto de autenticação compartilhado para resolver o usuário atual para campos de auditoria.